{
  "dbConnections": {
    "mongo-primary": {
      "mongoUri": "mongodb+srv://user:pass@primary-cluster.mongodb.net/?retryWrites=true&w=majority"
    },
    "mongo-analytics": {
      "mongoUri": "mongodb+srv://user:pass@analytics-cluster.mongodb.net/?retryWrites=true&w=majority"
    }
  },
  "spacesConnections": {
    "do-spaces": {
      "endpoint": "https://nyc3.digitaloceanspaces.com",
      "region": "nyc3",
      "accessKey": "YOUR_DO_SPACES_ACCESS_KEY",
      "secretKey": "YOUR_DO_SPACES_SECRET_KEY",
      "forcePathStyle": true
    },
    "do-spaces-eu": {
      "endpoint": "https://fra1.digitaloceanspaces.com",
      "region": "fra1",
      "accessKey": "YOUR_DO_SPACES_ACCESS_KEY",
      "secretKey": "YOUR_DO_SPACES_SECRET_KEY",
      "forcePathStyle": true
    }
  },
  "databases": {
    "metadata": {
      "genericDatabase": {
        "dbConnRef": "mongo-primary",
        "spaceConnRef": "do-spaces",
        "bucket": "chronos-metadata",
        "dbName": "chronos_metadata_generic"
      },
      "domainsDatabases": [
        {
          "domain": "ecommerce",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces",
          "bucket": "chronos-metadata-ecommerce",
          "dbName": "chronos_metadata_ecommerce"
        }
      ],
      "tenantDatabases": [
        {
          "tenantId": "store-a",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces",
          "bucket": "chronos-metadata-store-a",
          "dbName": "chronos_metadata_store_a"
        },
        {
          "tenantId": "store-b",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces-eu",
          "bucket": "chronos-metadata-store-b",
          "dbName": "chronos_metadata_store_b"
        }
      ]
    },
    "knowledge": {
      "genericDatabase": {
        "dbConnRef": "mongo-primary",
        "spaceConnRef": "do-spaces",
        "bucket": "chronos-knowledge",
        "dbName": "chronos_knowledge_generic"
      },
      "domainsDatabases": [
        {
          "domain": "ecommerce",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces",
          "bucket": "chronos-knowledge-ecommerce",
          "dbName": "chronos_knowledge_ecommerce"
        }
      ],
      "tenantDatabases": [
        {
          "tenantId": "store-a",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces",
          "bucket": "chronos-knowledge-store-a",
          "dbName": "chronos_knowledge_store_a"
        },
        {
          "tenantId": "store-b",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces-eu",
          "bucket": "chronos-knowledge-store-b",
          "dbName": "chronos_knowledge_store_b"
        }
      ]
    },
    "runtime": {
      "tenantDatabases": [
        {
          "tenantId": "store-a",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces",
          "bucket": "chronos-runtime-store-a",
          "dbName": "chronos_runtime_store_a",
          "analyticsDbName": "chronos_analytics_store_a"
        },
        {
          "tenantId": "store-b",
          "dbConnRef": "mongo-primary",
          "spaceConnRef": "do-spaces-eu",
          "bucket": "chronos-runtime-store-b",
          "dbName": "chronos_runtime_store_b",
          "analyticsDbName": "chronos_analytics_store_b"
        }
      ]
    },
    "logs": {
      "dbConnRef": "mongo-primary",
      "spaceConnRef": "do-spaces",
      "bucket": "chronos-logs",
      "dbName": "chronos_logs"
    }
  },
  "routing": {
    "hashAlgo": "rendezvous",
    "chooseKey": "tenantId|dbName|collection:objectId"
  },
  "retention": {
    "ver": {
      "days": 60,
      "maxPerItem": 500
    },
    "counters": {
      "days": 30,
      "weeks": 8,
      "months": 6
    }
  },
  "collectionMaps": {
    "products": {
      "indexedProps": ["sku", "tenantId", "category", "price", "status"],
      "base64Props": {
        "image": {
          "contentType": "image/jpeg",
          "preferredText": false
        },
        "description": {
          "contentType": "text/html",
          "preferredText": true,
          "textCharset": "utf-8"
        }
      },
      "validation": {
        "requiredIndexed": ["sku", "tenantId"]
      }
    },
    "orders": {
      "indexedProps": ["orderId", "customerId", "tenantId", "status", "total", "createdAt"],
      "validation": {
        "requiredIndexed": ["orderId", "customerId", "tenantId"]
      }
    },
    "customers": {
      "indexedProps": ["email", "tenantId", "status", "createdAt"],
      "validation": {
        "requiredIndexed": ["email", "tenantId"]
      }
    },
    "inventory": {
      "indexedProps": ["sku", "tenantId", "quantity", "location"],
      "validation": {
        "requiredIndexed": ["sku", "tenantId"]
      }
    }
  },
  "counterRules": {
    "rules": [
      {
        "name": "product_created",
        "on": ["CREATE"],
        "scope": "meta",
        "when": {
          "collection": "products"
        }
      },
      {
        "name": "order_created",
        "on": ["CREATE"],
        "scope": "meta",
        "when": {
          "collection": "orders"
        }
      },
      {
        "name": "order_completed",
        "on": ["UPDATE"],
        "scope": "payload",
        "when": {
          "collection": "orders",
          "payload.status": "completed"
        }
      },
      {
        "name": "inventory_updated",
        "on": ["UPDATE"],
        "scope": "payload",
        "when": {
          "collection": "inventory",
          "payload.quantity": { "$exists": true }
        }
      }
    ]
  },
  "devShadow": {
    "enabled": true,
    "ttlHours": 12,
    "maxBytesPerDoc": 524288
  },
  "logicalDelete": {
    "enabled": true
  },
  "versioning": {
    "enabled": true
  },
  "writeOptimization": {
    "batchSize": 500,
    "debounceMs": 200,
    "compressionEnabled": true
  },
  "fallback": {
    "enabled": true,
    "maxRetries": 5,
    "retryDelayMs": 2000,
    "maxDelayMs": 120000,
    "deadLetterCollection": "chronos_fallback_dead"
  },
  "transactions": {
    "enabled": true,
    "autoDetect": true
  }
}